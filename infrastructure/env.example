# Home Assistant Configuration
HOME_ASSISTANT_URL=http://homeassistant.local:8123
HOME_ASSISTANT_TOKEN=your_long_lived_access_token_here

# Nabu Casa Fallback Configuration
NABU_CASA_URL=https://lwzisze94hrpqde9typkwgu5pptxdkoh.ui.nabu.casa
NABU_CASA_TOKEN=your_nabu_casa_long_lived_access_token_here

# Local Home Assistant Fallback (Optional)
LOCAL_HA_URL=http://localhost:8123
LOCAL_HA_TOKEN=your_local_ha_long_lived_access_token_here

# InfluxDB Configuration
INFLUXDB_URL=http://localhost:8086
INFLUXDB_USERNAME=admin
INFLUXDB_PASSWORD=admin123
INFLUXDB_ORG=ha-ingestor
INFLUXDB_BUCKET=home_assistant_events
INFLUXDB_TOKEN=ha-ingestor-token

# Weather API Configuration
WEATHER_API_KEY=your_openweathermap_api_key_here
WEATHER_API_URL=https://api.openweathermap.org/data/2.5
WEATHER_DEFAULT_LOCATION=Las Vegas,NV,US
WEATHER_ENRICHMENT_ENABLED=true
WEATHER_CACHE_MINUTES=15
WEATHER_RATE_LIMIT_PER_MINUTE=50
WEATHER_RATE_LIMIT_PER_DAY=900
WEATHER_REQUEST_TIMEOUT=10

# =============================================================================
# Carbon Intensity Configuration (WattTime API)
# =============================================================================

# Authentication Method (Choose ONE):

# Method 1: Username/Password (RECOMMENDED - automatic token refresh)
# Tokens are automatically refreshed every 25 minutes
WATTTIME_USERNAME=your_watttime_username
WATTTIME_PASSWORD=your_watttime_password

# Method 2: Static API Token (NOT RECOMMENDED - expires every 30 minutes)
# Use this only for testing or if you can't use username/password
# WATTTIME_API_TOKEN=your_token_here

# Grid Region Configuration
# US Regions: CAISO_NORTH, CAISO_SOUTH, ERCOT, PJM, NYISO, ISONE, MISO
# International: Contact WattTime for available regions (paid plans)
# Use WattTime region lookup API to find your specific region
GRID_REGION=CAISO_NORTH

# Notes:
# - Free tier: Limited to 1-2 US regions
# - Paid tier: Global coverage (12+ countries)
# - Register at: https://watttime.org
# - See implementation/WATTTIME_API_SETUP_GUIDE.md for registration steps

# Electricity Pricing Configuration
PRICING_PROVIDER=awattar
PRICING_API_KEY=

# Air Quality Configuration (uses WEATHER_API_KEY from above)
# Air quality service now uses OpenWeather API instead of AirNow
LATITUDE=36.1699
LONGITUDE=-115.1398

# Calendar Service Configuration (Home Assistant Integration)
# Create long-lived token: HA Profile → Security → Long-Lived Access Tokens
# List calendars: Developer Tools → States → filter "calendar"
CALENDAR_ENTITIES=calendar.primary
CALENDAR_FETCH_INTERVAL=900

# Smart Meter Configuration
# Options: home_assistant (pulls from HA sensors), emporia, sense, generic (mock data)
METER_TYPE=home_assistant
METER_API_TOKEN=
METER_DEVICE_ID=
# Note: When METER_TYPE=home_assistant, uses HOME_ASSISTANT_URL and HOME_ASSISTANT_TOKEN above

# Energy Correlation Configuration
ENERGY_CORRELATION_INTERVAL=60  # Process events every 60 seconds
ENERGY_LOOKBACK_MINUTES=5       # Look back 5 minutes for events to process

# S3 Archival Configuration (Optional)
S3_ARCHIVE_BUCKET=
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1

# Logging Configuration
LOG_LEVEL=INFO

# WebSocket Retry Configuration
# Number of retry attempts before giving up (-1 = infinite, recommended for production)
WEBSOCKET_MAX_RETRIES=-1
# Maximum delay between retry attempts in seconds (default: 300 = 5 minutes)
WEBSOCKET_MAX_RETRY_DELAY=300

# Timezone Configuration
TZ=America/Los_Angeles

# Authentication Configuration
JWT_SECRET_KEY=super-secret-jwt-key
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
ADMIN_PASSWORD=adminpass

# Data Retention Configuration
CLEANUP_INTERVAL_HOURS=24
MONITORING_INTERVAL_MINUTES=5
COMPRESSION_INTERVAL_HOURS=24
BACKUP_INTERVAL_HOURS=24
BACKUP_DIR=/backups

# Service Configuration
ENABLE_WEATHER_API=false
ENABLE_AUTH=false

# Service Ports
ADMIN_API_PORT=8003
WEBSOCKET_INGESTION_PORT=8001
ENRICHMENT_PIPELINE_PORT=8002
DATA_RETENTION_PORT=8080
HEALTH_DASHBOARD_PORT=3000
WEATHER_API_PORT=8001
INFLUXDB_PORT=8086
HA_SIMULATOR_PORT=8123

# HA Simulator Configuration
SIMULATOR_PORT=8123
SIMULATOR_AUTH_TOKEN=dev_simulator_token
SIMULATOR_HA_VERSION=2025.10.1
SIMULATOR_LOG_LEVEL=INFO
